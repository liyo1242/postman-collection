{
	"info": {
		"_postman_id": "cae8864b-e132-4bc6-9cf7-46f3346df524",
		"name": "ManagerClock_API_testing",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "取得ComLogingToken",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"取得comLoginToken api回傳200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"var jsonData = pm.cookies.get('comLoginToken');\r",
							"pm.collectionVariables.set('comLoginToken', jsonData)\r",
							"\r",
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"const url = pm.environment.get('kingnetsmart')\r",
							"pm.sendRequest({\r",
							"    url: `${url}/mvc/api/Login/CheckAccountPassword`,\r",
							"    method: 'POST',\r",
							"    header: {\r",
							"        'content-type': 'application/json',\r",
							"    },\r",
							"    body: {\r",
							"        mode: 'raw',\r",
							"        raw: JSON.stringify({\r",
							"            \"Account\": \"092122931_\",\r",
							"            \"Password\": \"850404\",\r",
							"            \"Latitude\": 0,\r",
							"            \"Longitude\": 0\r",
							"        })\r",
							"    }\r",
							"}, function (err, response) {\r",
							"    const jsonResponse = response.json();\r",
							"    pm.collectionVariables.set(\"housekeeperToken\", jsonResponse.Data.Token);\r",
							"    pm.collectionVariables.set(\"Com_id\", jsonResponse.Data.communities[1].Id);\r",
							"});\r",
							"\r",
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"    console.log(realtime)\r",
							"});\r",
							"// Date.prototype.yyyymmdd = function() {\r",
							"//   var mm = this.getMonth() + 1; // getMonth() is zero-based\r",
							"//   var dd = this.getDate();\r",
							"\r",
							"//   return [this.getFullYear(),\r",
							"//           (mm>9 ? '' : '0') + mm,\r",
							"//           (dd>9 ? '' : '0') + dd\r",
							"//          ].join('-');\r",
							"// };\r",
							"// var date = new Date();\r",
							"// pm.collectionVariables.set(\"Today\", date.yyyymmdd());\r",
							"// console.log(date.yyyymmdd());\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "Token",
							"value": "{{housekeeperToken}}",
							"type": "default"
						},
						{
							"key": "ComId",
							"value": "{{Com_id}}",
							"type": "default"
						},
						{
							"key": "BrowserPushToken",
							"value": "eCMc3tK_sLs:APA91bGcfiIVEbdw9Z-DsbzomG0w8My2Ke440GJAERkefOp-M1ABdo7l2whAl3A8n7hIUZQ81sEV9G5YpdUGoGBGOnh132IcfS4q47PxGnle6c8XidnSK5uIwaPqlXyIbRAg80fuiGmC",
							"type": "default",
							"disabled": true
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/api/Login/CommunityLogin",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"api",
						"Login",
						"CommunityLogin"
					]
				}
			},
			"response": []
		},
		{
			"name": "驗證卡號_有綁定實名制帳號但未被加入企業雲",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"pm.test(\"驗證卡號有綁定實名制帳號但未被加入企業雲\", function () {\r",
							"    pm.expect(jsonData.Data.AuthorizationInfo.Phone).to.eql(\"092122931_\");\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockCard\": \"123\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn/Validation",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn",
						"Validation"
					]
				}
			},
			"response": []
		},
		{
			"name": "驗證卡號_有綁定實名制帳號但已加入企業雲",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"pm.test(\"驗證卡號有綁定實名制帳號且被加入企業雲\", function () {\r",
							"    pm.expect(jsonData.Data.AuthorizationInfo).to.eql(null);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockCard\": \"321\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn/Validation",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn",
						"Validation"
					]
				}
			},
			"response": []
		},
		{
			"name": "驗證卡號_未綁定實名制帳號但未加入企業雲",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"pm.test(\"驗證卡號未綁定實名制帳號\", function () {\r",
							"    pm.expect(jsonData.ErrorMessage.Description).to.eql(\"您尚未註冊實名制帳號，請點選註冊申辦。(點註冊跳轉至註冊頁面)\");\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockCard\": \"0000000000000\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn/Validation",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn",
						"Validation"
					]
				}
			},
			"response": []
		},
		{
			"name": "取得該社區職務班別",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"取得社區職務班別 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"\r",
							"const jsonData = pm.response.json();\r",
							"// console.log(jsonData.Data.ShiftClasses[0].Id)\r",
							"pm.collectionVariables.set('JobTitles', jsonData.Data.JobTitles[0].Id)\r",
							"pm.collectionVariables.set('ShiftClasses', jsonData.Data.ShiftClasses[0].Id)"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/CompanyJobTitleAndShiftClass",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"CompanyJobTitleAndShiftClass"
					]
				}
			},
			"response": []
		},
		{
			"name": "(上班)實名制打卡_有綁企業雲",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"實名制打卡_有綁企業雲 上班打卡成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"實名制打卡_有綁企業雲 打卡狀態正確\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    pm.expect(jsonData.Status).to.eql(1);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "ClockCard",
							"value": "321",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn"
					]
				}
			},
			"response": []
		},
		{
			"name": "取得未下班打卡的資料_實名制打卡有綁企業雲",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"pm.test(\"取得未下班打卡的資料成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"\r",
							"pm.test(\"未下班打卡打卡資料 有綁實名制打卡正確\", function () {\r",
							"    pm.expect(jsonData.Data[0].ClockTime).to.include(realtime);\r",
							"});\r",
							"\r",
							"pm.collectionVariables.set('enterpriseClockID', jsonData.Data[0].ClockId)\r",
							"\r",
							"\r",
							"// let arr = []\r",
							"// for(let i = 0; i < jsonData.Data.length; i++){\r",
							"//     console.log(jsonData.Data[i].ClockId)\r",
							"//     arr.push(jsonData.Data[i].ClockId)\r",
							"// }\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/NoClockOut",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"NoClockOut"
					]
				}
			},
			"response": []
		},
		{
			"name": "(下班)載具打卡_下班有綁在企業雲的上班打卡",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"實名制打卡_有綁企業雲 下班打卡成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確_實名制打卡有綁企業雲\", function(){\r",
							"    pm.expect(jsonData.Data.Name).to.equal('羅恩圻')\r",
							"    pm.expect(jsonData.Data.ClockTime).to.include(realtime)\r",
							"})"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "ClockCard",
							"value": "321",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{enterpriseClockID}}/ClockOut",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{enterpriseClockID}}",
						"ClockOut"
					]
				}
			},
			"response": []
		},
		{
			"name": "異動上下班打卡備註(實名制有綁企業雲)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"異動上下班打卡備註(實名制有綁企業雲)成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					},
					{
						"key": "KingnetAuth",
						"value": "Cookies XXXXXXXXXXXXXXXXXXXX"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockInNote\": \"API testing clockIn\", \"ClockOutNote\": \"API testing clockOut\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{enterpriseClockID}}",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{enterpriseClockID}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "篩選打卡紀錄_確認上下班資料(實名制打卡有綁企業雲)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const date = datetime.split('T')[0]\r",
							"    pm.collectionVariables.set(\"date\", date);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const clockid = pm.collectionVariables.get('enterpriseClockID')\r",
							"\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-clockid\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockId).to.eql(clockid);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-ManagerName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerName).to.eql(\"羅恩圻\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-ManagerJob\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerJob).to.eql(\"秘書\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-ManagerShifts\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerShifts).to.eql(\"早班\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-ClockStatusName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockStatusName).to.eql(\"正常\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-AbnormalNote\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].AbnormalNote).to.eql(null);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-上班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[0].Note).to.eql('API testing clockIn');\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-下班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[1].Note).to.eql('API testing clockOut');\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock?Offset=0&MaxCount=10&Filter.DateAt.StartAt={{date}}&Filter.DateAt.DueAt={{date}}&Filter.NoClockOut=false",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock"
					],
					"query": [
						{
							"key": "Offset",
							"value": "0"
						},
						{
							"key": "MaxCount",
							"value": "10"
						},
						{
							"key": "Filter.DateAt.StartAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.DateAt.DueAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.NoClockOut",
							"value": "false"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "(上班)實名制打卡_沒有綁企業雲",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"實名制打卡_沒有綁企業雲 打卡成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"實名制打卡_沒有綁企業雲 打卡狀態正確\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    pm.expect(jsonData.Status).to.eql(1);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "ClockCard",
							"value": "123",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						},
						{
							"key": "JobTitleId",
							"value": "{{JobTitles}}",
							"type": "text"
						},
						{
							"key": "ShiftClassId",
							"value": "{{ShiftClasses}}",
							"type": "text"
						},
						{
							"key": "Note",
							"value": "API testing",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn/NotInCompany",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn",
						"NotInCompany"
					]
				}
			},
			"response": []
		},
		{
			"name": "取得未下班打卡的資料_實名制打卡沒有綁企業雲",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"未下班打卡打卡資料 沒有綁實名制打卡正確\", function () {\r",
							"    pm.expect(jsonData.Data[0].ClockTime).to.include(realtime);\r",
							"});\r",
							"\r",
							"pm.collectionVariables.set('noEnterpriseClockID', jsonData.Data[0].ClockId)\r",
							"\r",
							"\r",
							"// let arr = []\r",
							"// for(let i = 0; i < jsonData.Data.length; i++){\r",
							"//     console.log(jsonData.Data[i].ClockId)\r",
							"//     arr.push(jsonData.Data[i].ClockId)\r",
							"// }\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/NoClockOut",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"NoClockOut"
					]
				}
			},
			"response": []
		},
		{
			"name": "(下班)載具打卡_下班沒有綁在企業雲的上班打卡",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"實名制打卡_沒有綁企業雲 下班打卡成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確_實名制打卡沒有綁企業雲\", function(){\r",
							"    pm.expect(jsonData.Data.Name).to.equal('羅恩圻')\r",
							"    pm.expect(jsonData.Data.ClockTime).to.include(realtime)\r",
							"})"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "ClockCard",
							"value": "123",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{noEnterpriseClockID}}/ClockOut",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{noEnterpriseClockID}}",
						"ClockOut"
					]
				}
			},
			"response": []
		},
		{
			"name": "異動上下班打卡備註(實名制沒有綁企業雲)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"異動上下班打卡備註(實名制沒有綁企業雲)成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					},
					{
						"key": "KingnetAuth",
						"value": "Cookies XXXXXXXXXXXXXXXXXXXX"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockInNote\": \"API testing clockIn\", \"ClockOutNote\": \"API testing clockOut\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{noEnterpriseClockID}}",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{noEnterpriseClockID}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "篩選打卡紀錄_確認上下班資料(實名制打卡沒有綁企業雲)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const date = datetime.split('T')[0]\r",
							"    pm.collectionVariables.set(\"date\", date);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const clockid = pm.collectionVariables.get('noEnterpriseClockID')\r",
							"\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡沒有綁企業雲)-clockid\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockId).to.eql(clockid);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡沒有綁企業雲)-ManagerName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerName).to.eql(\"羅恩圻\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡沒有綁企業雲)-ManagerJob\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerJob).to.eql(\"測試\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡沒有綁企業雲)-ManagerShifts\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerShifts).to.eql(\"早班\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡沒有綁企業雲)-ClockStatusName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockStatusName).to.eql(\"待審核\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡沒有綁企業雲)-AbnormalNote\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].AbnormalNote).to.eql(\"尚未加入企業\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-上班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[0].Note).to.eql('API testing clockIn');\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-下班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[1].Note).to.eql('API testing clockOut');\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock?Offset=0&MaxCount=10&Filter.DateAt.StartAt={{date}}&Filter.DateAt.DueAt={{date}}&Filter.NoClockOut=false",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock"
					],
					"query": [
						{
							"key": "Offset",
							"value": "0"
						},
						{
							"key": "MaxCount",
							"value": "10"
						},
						{
							"key": "Filter.DateAt.StartAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.DateAt.DueAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.NoClockOut",
							"value": "false"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "(上班)一次性打卡_已註冊實名制帳號",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"一次性打卡_驗證已註冊實名制帳號\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    pm.expect(jsonData.Data.HasAuthorization).to.eql(true);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "Phone",
							"value": "0921229318",
							"type": "text"
						},
						{
							"key": "Name",
							"value": "羅恩圻",
							"type": "text"
						},
						{
							"key": "JobTitleId",
							"value": "2",
							"type": "text"
						},
						{
							"key": "ShiftClassId",
							"value": "1",
							"type": "text"
						},
						{
							"key": "Note",
							"value": "API testing",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn/OneTime",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn",
						"OneTime"
					]
				}
			},
			"response": []
		},
		{
			"name": "取得未下班打卡的資料_一次性打卡已註冊實名制",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"未下班打卡打卡資料 沒有綁實名制打卡正確\", function () {\r",
							"    pm.expect(jsonData.Data[0].ClockTime).to.include(realtime);\r",
							"});\r",
							"\r",
							"pm.collectionVariables.set('OneTimeEnterpriseClockID', jsonData.Data[0].ClockId)\r",
							"\r",
							"\r",
							"// let arr = []\r",
							"// for(let i = 0; i < jsonData.Data.length; i++){\r",
							"//     console.log(jsonData.Data[i].ClockId)\r",
							"//     arr.push(jsonData.Data[i].ClockId)\r",
							"// }\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/NoClockOut",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"NoClockOut"
					]
				}
			},
			"response": []
		},
		{
			"name": "(下班)一次性打卡_已註冊實名制_手機號碼錯誤",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"手機號碼錯誤提示正確\", function(){\r",
							"    pm.expect(jsonData.ErrorMessage.Description).to.equal('您所輸入的手機與上班紀錄不符，請重新輸入。')\r",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "Phone",
							"value": "0921229310",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{OneTimeEnterpriseClockID}}/ClockOut/OneTime",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{OneTimeEnterpriseClockID}}",
						"ClockOut",
						"OneTime"
					]
				}
			},
			"response": []
		},
		{
			"name": "(下班)一次性打卡_已註冊實名制",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"一次性打卡_已註冊實名制 下班打卡成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確_一次性打卡_已註冊實名制\", function(){\r",
							"    pm.expect(jsonData.Data.Name).to.equal('羅恩圻')\r",
							"    pm.expect(jsonData.Data.ClockTime).to.include(realtime)\r",
							"})"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "Phone",
							"value": "0921229318",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{OneTimeEnterpriseClockID}}/ClockOut/OneTime",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{OneTimeEnterpriseClockID}}",
						"ClockOut",
						"OneTime"
					]
				}
			},
			"response": []
		},
		{
			"name": "異動上下班打卡備註(一次性打卡已註冊實名制)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"異動上下班打卡備註(一次性打卡已註冊實名制)成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					},
					{
						"key": "KingnetAuth",
						"value": "Cookies XXXXXXXXXXXXXXXXXXXX"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockInNote\": \"API testing clockIn\", \"ClockOutNote\": \"API testing clockOut\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{OneTimeEnterpriseClockID}}",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{OneTimeEnterpriseClockID}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "篩選打卡紀錄_確認上下班資料(一次性打卡已註冊實名制)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const date = datetime.split('T')[0]\r",
							"    pm.collectionVariables.set(\"date\", date);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const clockid = pm.collectionVariables.get('OneTimeEnterpriseClockID')\r",
							"\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡已註冊實名制)-clockid\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockId).to.eql(clockid);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡已註冊實名制)-ManagerName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerName).to.eql(\"羅恩圻\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡已註冊實名制)-ManagerJob\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerJob).to.eql(\"測試\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡已註冊實名制)-ManagerShifts\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerShifts).to.eql(\"早班\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡已註冊實名制)-ClockStatusName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockStatusName).to.eql(\"待審核\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡已註冊實名制)-AbnormalNote\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].AbnormalNote).to.eql(\"一次性打卡\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-上班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[0].Note).to.eql('API testing clockIn');\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-下班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[1].Note).to.eql('API testing clockOut');\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock?Offset=0&MaxCount=10&Filter.DateAt.StartAt={{date}}&Filter.DateAt.DueAt={{date}}&Filter.NoClockOut=false",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock"
					],
					"query": [
						{
							"key": "Offset",
							"value": "0"
						},
						{
							"key": "MaxCount",
							"value": "10"
						},
						{
							"key": "Filter.DateAt.StartAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.DateAt.DueAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.NoClockOut",
							"value": "false"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "(上班)一次性打卡_未註冊實名制帳號",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"一次性打卡_驗證未註冊實名制帳號\", function () {\r",
							"    var jsonData = pm.response.json();\r",
							"    pm.expect(jsonData.Data.HasAuthorization).to.eql(false);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "Phone",
							"value": "0944444444",
							"type": "text"
						},
						{
							"key": "Name",
							"value": "測試",
							"type": "text"
						},
						{
							"key": "JobTitleId",
							"value": "2",
							"type": "text"
						},
						{
							"key": "ShiftClassId",
							"value": "1",
							"type": "text"
						},
						{
							"key": "Note",
							"value": "test",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/ClockIn/OneTime",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"ClockIn",
						"OneTime"
					]
				}
			},
			"response": []
		},
		{
			"name": "取得未下班打卡的資料_一次性打卡未註冊實名制",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"未下班打卡打卡資料 沒有綁實名制打卡正確\", function () {\r",
							"    pm.expect(jsonData.Data[0].ClockTime).to.include(realtime);\r",
							"});\r",
							"\r",
							"pm.collectionVariables.set('OneTimeNoEnterpriseClockID', jsonData.Data[0].ClockId)\r",
							"\r",
							"// let test = jsonData.Data.map( x => x.ClockId )\r",
							"// console.log(test)\r",
							"\r",
							"// let arr = []\r",
							"// for(let i = 0; i < jsonData.Data.length; i++){\r",
							"//     console.log(jsonData.Data[i].ClockId)\r",
							"//     arr.push(jsonData.Data[i].ClockId)\r",
							"// }\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/NoClockOut",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"NoClockOut"
					]
				}
			},
			"response": []
		},
		{
			"name": "(下班)一次性打卡_未註冊實名制",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const realtime = datetime.split('T')[0] + ' ' + datetime.split('T')[1].substr(0, 5)\r",
							"    pm.collectionVariables.set(\"realtime\", realtime);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const realtime = pm.collectionVariables.get('realtime')\r",
							"\r",
							"pm.test(\"一次性打卡_未註冊實名制 下班打卡成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確_一次性打卡_未註冊實名制\", function(){\r",
							"    pm.expect(jsonData.Data.Name).to.equal('測試')\r",
							"    pm.expect(jsonData.Data.ClockTime).to.include(realtime)\r",
							"})"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "Phone",
							"value": "0944444444",
							"type": "text"
						},
						{
							"key": "Longitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "Latitude",
							"value": "0",
							"type": "text"
						},
						{
							"key": "IsWarning",
							"value": "false",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{OneTimeNoEnterpriseClockID}}/ClockOut/OneTime",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{OneTimeNoEnterpriseClockID}}",
						"ClockOut",
						"OneTime"
					]
				}
			},
			"response": []
		},
		{
			"name": "異動上下班打卡備註(一次性打卡未註冊實名制)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"異動上下班打卡備註(一次性打卡未註冊實名制)成功 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					},
					{
						"key": "KingnetAuth",
						"value": "Cookies XXXXXXXXXXXXXXXXXXXX"
					},
					{
						"key": "Content-Type",
						"value": "application/json-patch+json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{ \"ClockInNote\": \"API testing clockIn\", \"ClockOutNote\": \"API testing clockOut\"}"
				},
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/{{OneTimeNoEnterpriseClockID}}",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"{{OneTimeNoEnterpriseClockID}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "篩選打卡紀錄_確認上下班資料(一次性打卡未註冊實名制)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.sendRequest(\"http://worldtimeapi.org/api/timezone/Asia/Taipei\", function (err, res) {\r",
							"    const datetime = res.json().datetime\r",
							"    const date = datetime.split('T')[0]\r",
							"    pm.collectionVariables.set(\"date\", date);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const jsonData = pm.response.json();\r",
							"const clockid = pm.collectionVariables.get('OneTimeNoEnterpriseClockID')\r",
							"\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡未註冊實名制)-clockid\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockId).to.eql(clockid);\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡未註冊實名制)-ManagerName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerName).to.eql(\"測試\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡未註冊實名制)-ManagerJob\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerJob).to.eql(\"測試\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡未註冊實名制)-ManagerShifts\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ManagerShifts).to.eql(\"早班\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡未註冊實名制)-ClockStatusName\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].ClockStatusName).to.eql(\"待審核\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(一次性打卡未註冊實名制)-AbnormalNote\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].AbnormalNote).to.eql(\"一次性打卡\");\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-上班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[0].Note).to.eql('API testing clockIn');\r",
							"});\r",
							"pm.test(\"驗證打卡資料正確(實名制打卡有綁企業雲)-下班備註\", function () {\r",
							"   pm.expect(jsonData.Data.ManagerClocks[0].Contents[1].Note).to.eql('API testing clockOut');\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "text/plain"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock?Offset=0&MaxCount=10&Filter.DateAt.StartAt={{date}}&Filter.DateAt.DueAt={{date}}&Filter.NoClockOut=false",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock"
					],
					"query": [
						{
							"key": "Offset",
							"value": "0"
						},
						{
							"key": "MaxCount",
							"value": "10"
						},
						{
							"key": "Filter.DateAt.StartAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.DateAt.DueAt",
							"value": "{{date}}"
						},
						{
							"key": "Filter.NoClockOut",
							"value": "false"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "匯出打卡紀錄excel",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const Content = pm.response.headers.get('Content-Disposition')\r",
							"const excelName = decodeURI(Content)\r",
							"\r",
							"pm.test(\"匯出excel資料顯示正確\", function () {\r",
							"    pm.expect(excelName).to.include('智生活差勤管理上下班打卡紀錄');\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "accept",
						"value": "application/json"
					}
				],
				"url": {
					"raw": "{{kingnetsmart}}/core/api/ManagerClock/Excel?DateAt.StartAt={{date}}&DateAt.DueAt={{date}}&NoClockOut=false",
					"host": [
						"{{kingnetsmart}}"
					],
					"path": [
						"core",
						"api",
						"ManagerClock",
						"Excel"
					],
					"query": [
						{
							"key": "DateAt.StartAt",
							"value": "{{date}}"
						},
						{
							"key": "DateAt.DueAt",
							"value": "{{date}}"
						},
						{
							"key": "NoClockOut",
							"value": "false"
						}
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "JobTitles",
			"value": ""
		},
		{
			"key": "ShiftClasses",
			"value": ""
		},
		{
			"key": "Today",
			"value": ""
		},
		{
			"key": "housekeeperToken",
			"value": ""
		},
		{
			"key": "Com_id",
			"value": ""
		},
		{
			"key": "comLoginToken",
			"value": ""
		},
		{
			"key": "realtime",
			"value": ""
		},
		{
			"key": "enterpriseClockID",
			"value": ""
		},
		{
			"key": "noEnterpriseClockID",
			"value": ""
		},
		{
			"key": "OneTimeEnterpriseClockID",
			"value": ""
		},
		{
			"key": "OneTimeNoEnterpriseClockID",
			"value": ""
		},
		{
			"key": "date",
			"value": ""
		}
	]
}